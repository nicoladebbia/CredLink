# Phase 36 Billing Environment Configuration
# CRITICAL SECURITY: Use strong, unique secrets in production

# Server Configuration
NODE_ENV=development
HOST=0.0.0.0
PORT=3002
LOG_LEVEL=info
LOG_FORMAT=pretty

# Redis Configuration - CRITICAL: Use TLS in production
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=your-strong-redis-password-with-special-chars-123!
REDIS_MAX_RETRIES=3
REDIS_TLS=false

# Stripe Configuration (REQUIRED) - CRITICAL: Use live keys in production
STRIPE_SECRET_KEY=sk_test_...
STRIPE_PUBLISHABLE_KEY=pk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...
STRIPE_API_VERSION=2023-10-16

# Stripe Product IDs (configure in Stripe Dashboard)
STRIPE_STARTER_PRICE_ID=price_1...
STRIPE_PRO_PRICE_ID=price_1...
STRIPE_ENTERPRISE_PRICE_ID=price_1...

# Stripe Usage Meter IDs
STRIPE_SIGN_EVENTS_METER_ID=meter_1...
STRIPE_VERIFY_EVENTS_METER_ID=meter_1...
STRIPE_RFC3161_TIMESTAMPS_METER_ID=meter_1...

# Database Configuration - CRITICAL: Use SSL and strong credentials
DATABASE_URL=postgresql://user:strong-password@localhost:5432/c2pa_billing?sslmode=require
DATABASE_POOL_SIZE=10
DATABASE_TIMEOUT=30000

# Security Configuration - CRITICAL: Use 128+ character secrets with maximum entropy
JWT_SECRET=Your-Super-Secure-JWT-Secret-Key-128-Characters-Minimum-With-Uppercase-Lowercase-Numbers-And-Special-Characters!@#$%^&*()
API_KEY_SECRET=Your-Super-Secure-API-Key-Secret-64-Characters-Minimum-With-Uppercase-Lowercase-Numbers-And-Special-Characters!@#$%
SESSION_TIMEOUT=3600000
RATE_LIMIT_WINDOW=900000
MAX_REQUESTS_PER_WINDOW=100

# Trial Configuration
TRIAL_DURATION_DAYS=14
TRIAL_ASSET_CAP=200
TRIAL_CARD_REQUIRED=true

# RFC-3161 TSA Configuration
RFC3161_TSA_ENDPOINT=http://tsa.example.com
RFC3161_TSA_USERNAME=tsa-user
RFC3161_TSA_PASSWORD=tsa-password-with-special-chars-123!
RFC3161_TSA_TIMEOUT=10000

# OpenTelemetry Configuration - CRITICAL: Configure for observability
OTEL_SERVICE_NAME=c2pa-billing
OTEL_SERVICE_NAMESPACE=c2pa
OTEL_SERVICE_VERSION=1.1.0
OTEL_DEPLOYMENT_ENVIRONMENT=development
OTEL_RESOURCE_ATTRIBUTES=service.instance.id=c2pa-billing-1,cloud.provider=aws,cloud.region=us-east-1

# OpenTelemetry Exporters
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318
OTEL_EXPORTER_OTLP_TRACES_ENDPOINT=http://localhost:4318/v1/traces
OTEL_EXPORTER_OTLP_METRICS_ENDPOINT=http://localhost:4318/v1/metrics
OTEL_EXPORTER_OTLP_LOGS_ENDPOINT=http://localhost:4318/v1/logs
OTEL_EXPORTER_OTLP_HEADERS=Authorization=Bearer your-otel-token
OTEL_EXPORTER_OTLP_TIMEOUT=30000
OTEL_EXPORTER_OTLP_COMPRESSION=gzip

# OpenTelemetry Sampling
OTEL_TRACE_SAMPLER=parentbased_traceidratio
OTEL_TRACE_SAMPLER_ARG=0.01

# OpenTelemetry Batch Processing
OTEL_BSP_MAX_BATCH_SIZE=1024
OTEL_BSP_MAX_EXPORT_BATCH_SIZE=512
OTEL_BSP_EXPORT_TIMEOUT=30000
OTEL_BSP_SCHEDULE_DELAY=5000

# OpenTelemetry Metrics
OTEL_METRIC_EXPORT_INTERVAL=30000
OTEL_METRIC_EXPORT_TIMEOUT=30000

# Prometheus Exporter
PROMETHEUS_ENDPOINT=0.0.0.0:9464
PROMETHEUS_NAMESPACE=c2pa

# Loki Exporter
LOKI_ENDPOINT=http://localhost:3100/loki/api/v1/push
LOKI_USERNAME=loki-user
LOKI_PASSWORD=loki-password-with-special-chars-123!
LOKI_TENANT_ID=c2pa

# Tempo Exporter
TEMPO_ENDPOINT=http://localhost:4318
TEMPO_API_KEY=your-tempo-api-key

# SLO Configuration
SLO_WINDOW_DAYS=30
SLO_SURVIVAL_REMOTE_TARGET=0.999
SLO_SURVIVAL_EMBED_TARGET=0.95
SLO_VERIFY_LATENCY_P95_TARGET=600
SLO_SIGN_LATENCY_EMBED_P95_TARGET=800
SLO_SIGN_LATENCY_REMOTE_P95_TARGET=400
SLO_TSA_LATENCY_P95_TARGET=300

# Burn Rate Alerting
BURN_RATE_CRITICAL_MULTIPLIER=14.4
BURN_RATE_HIGH_MULTIPLIER=6.0
BURN_RATE_MODERATE_MULTIPLIER=2.0

# Alerting Configuration
ALERT_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
ALERT_SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
ALERT_PAGERDUTY_INTEGRATION_KEY=your-pagerduty-integration-key
ALERT_EMAIL_SMTP_HOST=smtp.gmail.com
ALERT_EMAIL_SMTP_PORT=587
ALERT_EMAIL_USERNAME=your-email@gmail.com
ALERT_EMAIL_PASSWORD=your-email-app-password

# GameDay Configuration
GAMEDAY_ENABLED=false
GAMEDAY_FAILURE_INJECTION_RATE=0.0

# Release Configuration
GIT_SHA=unknown
RELEASE_VERSION=1.1.0
RELEASE_TIME=2025-11-03T15:00:00.000Z

# Cost Tracking
COST_TRACKING_ENABLED=true
COST_PER_SIGN_EVENT=0.01
COST_PER_VERIFY_EVENT=0.005
COST_PER_TSA_TIMESTAMP=0.50
LOG_COST_PER_GB=0.50

# Log Budgeting
LOG_BUDGET_TENANT_GB_PER_MONTH=1

# File Storage Configuration - CRITICAL: Use secure storage paths
ASSET_STORAGE_PATH=./assets
EXPORT_STORAGE_PATH=./exports
MAX_ASSET_SIZE=104857600
MANIFEST_RETENTION_DAYS=365

# Email Configuration (for dunning and onboarding) - CRITICAL: Use API keys, not passwords
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USER=apikey
SMTP_PASS=your-sendgrid-api-key-secure
EMAIL_FROM=noreply@c2pa.org
EMAIL_SUPPORT=support@c2pa.org

# Compliance Configuration
COMPLIANCE_REPORT_SCHEDULE=0 0 1 * *
DATA_RETENTION_DAYS=2555
AUDIT_LOG_ENABLED=true
AUDIT_LOG_RETENTION_DAYS=2555

# Feature Flags - CRITICAL: Disable debug features in production
ENABLE_STRIPE_RADAR=true
ENABLE_SMART_RETRIES=true
ENABLE_USAGE_METERING=true
ENABLE_RFC3161_TIMESTAMPS=false
ENABLE_CUSTOMER_PORTAL=true

# Monitoring Configuration
ENABLE_METRICS=true
METRICS_PORT=9090
HEALTH_CHECK_INTERVAL=30000

# CORS Configuration - CRITICAL: Restrict to specific domains in production
ALLOWED_ORIGINS=http://localhost:3000,https://app.c2pa.org
CORS_CREDENTIALS=true

# Webhook Configuration - CRITICAL: Use strong timeout values
WEBHOOK_TIMEOUT=30000
WEBHOOK_RETRY_ATTEMPTS=3
WEBHOOK_RETRY_DELAY=1000
