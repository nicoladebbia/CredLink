<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{tenant}} - C2PA Survival Report {{period}}</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: white;
            color: #1e293b;
            line-height: 1.6;
        }

        .header {
            background: #0f172a;
            color: white;
            padding: 2rem;
            text-align: center;
        }

        .header h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .header .subtitle {
            font-size: 1.125rem;
            opacity: 0.8;
        }

        .meta {
            background: #f1f5f9;
            padding: 1rem 2rem;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .meta-item {
            display: flex;
            flex-direction: column;
        }

        .meta-label {
            font-size: 0.75rem;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .meta-value {
            font-weight: 600;
            color: #0f172a;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
        }

        .section {
            margin-bottom: 3rem;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e2e8f0;
        }

        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .summary-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 1.5rem;
            text-align: center;
        }

        .summary-card .value {
            font-size: 2rem;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 0.5rem;
        }

        .summary-card .label {
            font-size: 0.875rem;
            color: #64748b;
        }

        .status-pass {
            color: #059669;
        }

        .status-fail {
            color: #dc2626;
        }

        .survival-matrix {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            overflow: hidden;
        }

        .matrix-table {
            width: 100%;
            border-collapse: collapse;
        }

        .matrix-table th,
        .matrix-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }

        .matrix-table th {
            font-weight: 600;
            color: #374151;
            background: #f9fafb;
        }

        .matrix-table tr:hover {
            background: #f9fafb;
        }

        .survival-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }

        .survival-good {
            background: #059669;
        }

        .survival-bad {
            background: #dc2626;
        }

        .survival-unknown {
            background: #6b7280;
        }

        .methodology {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 1.5rem;
        }

        .methodology h3 {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #0f172a;
        }

        .methodology ul {
            list-style: none;
            padding: 0;
        }

        .methodology li {
            padding: 0.5rem 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .methodology li:before {
            content: "âœ“";
            color: #059669;
            font-weight: bold;
            margin-right: 0.5rem;
        }

        .methodology li:last-child {
            border-bottom: none;
        }

        .footer {
            background: #f1f5f9;
            padding: 2rem;
            text-align: center;
            border-top: 1px solid #e2e8f0;
            margin-top: 3rem;
        }

        .footer p {
            color: #64748b;
            font-size: 0.875rem;
        }

        .footer .disclaimer {
            font-style: italic;
            margin-top: 1rem;
        }

        @media print {
            .header {
                background: white;
                color: #0f172a;
                border-bottom: 2px solid #0f172a;
            }
            
            .meta {
                background: white;
                border-bottom: 1px solid #e2e8f0;
            }
            
            .footer {
                background: white;
                border-top: 1px solid #e2e8f0;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <h1>C2PA Survival Report</h1>
        <div class="subtitle">{{tenant}} - {{month}} {{year}}</div>
    </header>

    <div class="meta">
        <div class="meta-item">
            <span class="meta-label">Tenant</span>
            <span class="meta-value">{{tenant}}</span>
        </div>
        <div class="meta-item">
            <span class="meta-label">Report Period</span>
            <span class="meta-value">{{month}} {{year}}</span>
        </div>
        <div class="meta-item">
            <span class="meta-label">Generated</span>
            <span class="meta-value">{{formatDate generatedAt}}</span>
        </div>
        <div class="meta-item">
            <span class="meta-label">Report ID</span>
            <span class="meta-value">{{tenant}}-{{year}}-{{month}}</span>
        </div>
    </div>

    <div class="container">
        <!-- Executive Summary -->
        <section class="section">
            <h2 class="section-title">Executive Summary</h2>
            <div class="summary-cards">
                <div class="summary-card">
                    <div class="value status-pass">{{formatPercent sloStatus.0.survival_30d}}</div>
                    <div class="label">Remote Survival (Target: 99.9%)</div>
                </div>
                <div class="summary-card">
                    <div class="value status-pass">{{formatPercent sloStatus.1.survival_30d}}</div>
                    <div class="label">Embed Survival (Target: 95%)</div>
                </div>
                <div class="summary-card">
                    <div class="value">{{survivalData.length}}</div>
                    <div class="label">Routes Monitored</div>
                </div>
                <div class="summary-card">
                    <div class="value">{{formatNumber survivalData.0.total_requests}}</div>
                    <div class="label">Total Requests</div>
                </div>
            </div>
        </section>

        <!-- Daily Survival Matrix -->
        <section class="section">
            <h2 class="section-title">Daily Survival Matrix</h2>
            <div class="survival-matrix">
                <table class="matrix-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Route</th>
                            <th>Mode</th>
                            <th>Survival Rate</th>
                            <th>Total Requests</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{#each survivalData}}
                        <tr>
                            <td>{{formatDate date}}</td>
                            <td>{{route}}</td>
                            <td>{{mode}}</td>
                            <td>{{formatPercent survival_rate}}</td>
                            <td>{{formatNumber total_requests}}</td>
                            <td>
                                <span class="survival-indicator {{#if (gte survival_rate 0.999)}}survival-good{{else}}{{#if (gte survival_rate 0.95)}}survival-good{{else}}survival-bad{{/if}}{{/if}}"></span>
                                {{#if (gte survival_rate 0.999)}}PASS{{else}}{{#if (gte survival_rate 0.95)}}PASS{{else}}FAIL{{/if}}{{/if}}
                            </td>
                        </tr>
                        {{/each}}
                    </tbody>
                </table>
            </div>
        </section>

        <!-- SLO Performance -->
        <section class="section">
            <h2 class="section-title">SLO Performance Summary</h2>
            <div class="survival-matrix">
                <table class="matrix-table">
                    <thead>
                        <tr>
                            <th>Route</th>
                            <th>Mode</th>
                            <th>30-Day Survival</th>
                            <th>Target</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{#each sloStatus}}
                        <tr>
                            <td>{{route}}</td>
                            <td>{{mode}}</td>
                            <td>{{formatPercent survival_30d}}</td>
                            <td>{{formatPercent survival_target}}</td>
                            <td><span class="status-{{survival_status}}">{{survival_status}}</span></td>
                        </tr>
                        {{/each}}
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Methodology -->
        <section class="section">
            <h2 class="section-title">Methodology & Standards</h2>
            <div class="methodology">
                <h3>Measurement Approach</h3>
                <ul>
                    <li>Survival rates calculated from actual delivery decisions across all edge locations</li>
                    <li>Remote survival target: 99.9% (hard SLO for production availability)</li>
                    <li>Embed survival target: 95% (advisory SLO for preserve-mode delivery)</li>
                    <li>Data collected from Cloudflare Workers and Delivery Optimization systems</li>
                    <li>Daily aggregates computed from 5-minute rollups for accuracy</li>
                </ul>
                
                <h3>Compliance Standards</h3>
                <ul>
                    <li>All measurements follow C2PA specification requirements</li>
                    <li>Survival defined as successful manifest validation and asset delivery</li>
                    <li>Timestamps in UTC, aggregated to daily boundaries</li>
                    <li>Privacy-compliant: no user-identifiable data included</li>
                    <li>Tamper-evident: reports include cryptographic hashes</li>
                </ul>

                <h3>Technical Details</h3>
                <ul>
                    <li>Analytics powered by ClickHouse columnar database</li>
                    <li>Real-time processing with 5-minute aggregation windows</li>
                    <li>Global edge measurement across 200+ locations</li>
                    <li>Automated anomaly detection and alerting</li>
                    <li>Retention: 90 days raw data, 365 days incident records</li>
                </ul>
            </div>
        </section>

        <!-- Verification -->
        <section class="section">
            <h2 class="section-title">Verification & Authenticity</h2>
            <div class="methodology">
                <p><strong>Report Authenticity:</strong> This report was generated automatically by the C2PA Analytics system. All metrics are derived from the same data source used for internal dashboards, ensuring consistency between public reports and operational monitoring.</p>
                <br>
                <p><strong>Data Integrity:</strong> Survival metrics are computed using identical SQL queries across both private dashboards and public reports. No separate calculation pipelines exist, eliminating drift between sales collateral and operational reality.</p>
                <br>
                <p><strong>Timestamp:</strong> {{formatDate generatedAt}} UTC</p>
                <p><strong>Report Version:</strong> 1.0</p>
                <p><strong>Schema Version:</strong> 13.1</p>
            </div>
        </section>
    </div>

    <footer class="footer">
        <p>Generated by C2PA Analytics - Phase 13 SKU v1</p>
        <p>For questions about this report, contact your C2PA representative</p>
        <p class="disclaimer">
            This report contains factual survival metrics and does not constitute legal advice.<br>
            All measurements are provided as-is and reflect actual system performance during the reporting period.
        </p>
    </footer>
</body>
</html>
