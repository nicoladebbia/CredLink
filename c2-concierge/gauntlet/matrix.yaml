version: 1
date: "2025-10-30"
description: "C2PA Content Credentials survival testing matrix"

providers:
  - cloudflare
  - imgix
  - cloudinary
  - fastly
  - akamai

routes:
  - id: preserve-embed
    description: "Provider configured to preserve metadata/embeds"
    expect_embed: true
    expect_remote: true
  - id: strip-happy
    description: "Aggressive transforms that commonly strip metadata"
    expect_embed: false
    expect_remote: true
  - id: remote-only
    description: "Embed ignored, remote manifest only"
    expect_embed: false
    expect_remote: true

transforms:
  - id: resize_1024
    description: "Resize to 1024px width"
    params:
      width: 1024
  - id: q_75
    description: "Quality 75%"
    params:
      quality: 75
  - id: format_webp
    description: "Convert to WebP format"
    params:
      format: webp
  - id: format_avif
    description: "Convert to AVIF format"
    params:
      format: avif
  - id: crop_1x1_center
    description: "Crop to 1:1 aspect ratio center"
    params:
      crop: "center"
      aspect_ratio: "1:1"
  - id: progressive_jpeg
    description: "Progressive JPEG encoding"
    params:
      progressive: true
  - id: rotate_90
    description: "Rotate 90 degrees"
    params:
      rotate: 90
  - id: sharpen
    description: "Apply sharpening"
    params:
      sharpen: true
  - id: gamma
    description: "Gamma/contrast adjustment"
    params:
      gamma: 1.2
      contrast: 1.1
  - id: png_to_jpg
    description: "Convert PNG to JPEG"
    params:
      format: jpeg
  - id: dpr_2
    description: "Device pixel ratio 2x"
    params:
      dpr: 2
  - id: provider_auto_optimize
    description: "Provider default auto-optimization"
    params:
      auto: true

assets:
  - id: portrait_1
    filename: "portrait-1.jpg"
    type: "image/jpeg"
    description: "Portrait photo with extensive EXIF/IPTC"
    has_c2pa: true
  - id: text_overlay_1
    filename: "text-overlay-1.png"
    type: "image/png"
    description: "PNG with text overlay and transparency"
    has_c2pa: true
  - id: alpha_1
    filename: "alpha-1.png"
    type: "image/png"
    description: "PNG with alpha channel"
    has_c2pa: true
  - id: wide_1
    filename: "wide-1.jpg"
    type: "image/jpeg"
    description: "Wide landscape photo"
    has_c2pa: true
  - id: dense_1
    filename: "dense-1.jpg"
    type: "image/jpeg"
    description: "High-density image with rich metadata"
    has_c2pa: true
  - id: graphic_1
    filename: "graphic-1.png"
    type: "image/png"
    description: "Graphic design with text"
    has_c2pa: true
  - id: photo_1
    filename: "photo-1.jpg"
    type: "image/jpeg"
    description: "Standard photograph"
    has_c2pa: true
  - id: artwork_1
    filename: "artwork-1.jpg"
    type: "image/jpeg"
    description: "Digital artwork"
    has_c2pa: true
  - id: banner_1
    filename: "banner-1.jpg"
    type: "image/jpeg"
    description: "Web banner image"
    has_c2pa: true
  - id: thumbnail_1
    filename: "thumbnail-1.jpg"
    type: "image/jpeg"
    description: "Thumbnail sized image"
    has_c2pa: true

# Test matrix combinations
# Total combinations: 5 providers × 3 routes × 12 transforms × 10 assets = 1,800 tests
expected_total_tests: 1800

# Success criteria
success_criteria:
  remote_survival_threshold: 99.9
  embed_survival_threshold: 0.0  # Embed is advisory only
  max_failures_remote: 1  # P0 if more than 1 remote failure
  timeout_seconds: 30
  retry_attempts: 3

# Reporting
reporting:
  include_headers: true
  include_timing: true
  include_provider_notes: true
  cache_duration_seconds: 31536000  # 1 year, immutable
