# S-10: Secrets Management
# NEVER commit actual secrets to git - this is an example file only
# Use AWS Secrets Manager, HashiCorp Vault, or similar in production

# ========================================
# CRITICAL SECRETS (Production: Use Secrets Manager)
# ========================================

# JWT Secret (rotate every 90 days)
JWT_SECRET=your-secure-random-secret-here-min-32-chars

# Database credentials (Production: Use IAM auth or Secrets Manager)
DATABASE_PASSWORD=your-database-password

# API Secrets for HMAC signing (one per API key)
API_SECRET_key1=secret-for-key1
API_SECRET_key2=secret-for-key2

# Encryption keys
ENCRYPTION_KEY=your-32-byte-encryption-key-in-base64

# ========================================
# AWS KMS (for certificate/key encryption)
# ========================================
AWS_REGION=us-east-1
KMS_KEY_ID=arn:aws:kms:region:account:key/key-id
ENCRYPTED_PRIVATE_KEY=base64-encrypted-private-key

# ========================================
# External Service API Keys
# ========================================

# VirusTotal (for malware scanning)
VIRUSTOTAL_API_KEY=your-virustotal-api-key

# Sentry (for error tracking)
SENTRY_DSN=https://your-sentry-dsn

# ========================================
# Security Configuration
# ========================================

# TLS Certificates
SSL_KEY_PATH=./certs/privkey.pem
SSL_CERT_PATH=./certs/fullchain.pem

# CORS Origins (comma-separated)
CORS_ORIGINS=https://app.credlink.com,https://dashboard.credlink.com

# Session Configuration
SESSION_SECRET=your-session-secret-min-32-chars

# ========================================
# Rotation Schedule
# ========================================

# Last rotated dates (for tracking)
# JWT_SECRET_ROTATED=2024-11-12
# DATABASE_PASSWORD_ROTATED=2024-10-01
# API_SECRETS_ROTATED=2024-09-15

# ========================================
# Production Deployment Notes
# ========================================

# 1. Use AWS Secrets Manager:
#    aws secretsmanager create-secret --name credlink/jwt-secret --secret-string "your-secret"
#
# 2. Use IAM roles for service authentication (no hardcoded credentials)
#
# 3. Rotate secrets automatically:
#    - JWT_SECRET: every 90 days
#    - Database passwords: every 90 days
#    - API secrets: on compromise or every 180 days
#
# 4. Use environment-specific secrets (dev/staging/prod)
#
# 5. Implement least privilege IAM policies
#
# 6. Enable CloudTrail for secrets access auditing
