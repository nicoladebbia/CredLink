apiVersion: v1
kind: Secret
metadata:
  name: phase36-secrets
  labels:
    app: phase36-billing
type: Opaque
data:
  # Base64 encoded secrets
  # Replace these with your actual encoded secrets
  redis-host: bG9jYWxob3N0  # localhost
  redis-port: NjM3OQ==        # 6379
  redis-password: eW91ci1zdHJvbmctcmVkaXMtcGFzc3dvcmQtd2l0aC1zcGVjaWFsLWNoYXJzLTEyMyE=  # your-strong-redis-password-with-special-chars-123!
  jwt-secret: WW91ci1TdXBlci1TZWN1cmUtSlhULVNlY3JldC1LZXktMTI4LUNoYXJhY3RlcnMtTWluaW11bS1XaXRoLVVwcGVyY2FzZS1Mb3dlcmNhc2UtTnVtYmVycy1BbmQtU3BlY2lhbC1DaGFyYWN0ZXJzIUAjJCVeJigp  # Your-Super-Secure-JWT-Secret-Key-128-Characters-Minimum-With-Uppercase-Lowercase-Numbers-And-Special-Characters!@#$%^&*()
  api-key-secret: WW91ci1TdXBlci1TZWN1cmUtQVBJLUtleS1TZWNyZXQtNjQtQ2hhcmFjdGVycy1NaW5pbXVtLVdpdGgtVXBwZXJjYXNlLUxvd2VyY2FzZS1OdW1iZXJzLUFuZC1TcGVjaWFsLUNoYXJhY3RlcnMhQCMk  # Your-Super-Secure-API-Key-Secret-64-Characters-Minimum-With-Uppercase-Lowercase-Numbers-And-Special-Characters!@#$
  stripe-secret-key: c2tfbGl2ZV8...  # Your actual Stripe secret key
  stripe-webhook-secret: d2hzZWNf...  # Your actual Stripe webhook secret

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: phase36-config
  labels:
    app: phase36-billing
data:
  stripe-starter-price-id: cHJpY2VfMQ==  # price_1...
  stripe-pro-price-id: cHJpY2VfMg==       # price_1...
  stripe-enterprise-price-id: cHJpY2VfMw== # price_1...
  allowed-origins: aHR0cHM6Ly9hcHAuYzJwYS5vcmcs aHR0cHM6Ly9hZG1pbi5jMnBhLm9yZw==  # https://app.c2pa.org,https://admin.c2pa.org
  sign-events-meter-id: bWV0ZXJfMQ==      # meter_1...
  verify-events-meter-id: bWV0ZXJfMg==    # meter_1...
  rfc3161-timestamps-meter-id: bWV0ZXJfMw== # meter_1...

---
apiVersion: v1
kind: ServiceMonitor
metadata:
  name: phase36-billing-monitor
  labels:
    app: phase36-billing
    release: prometheus
spec:
  selector:
    matchLabels:
      app: phase36-billing
  endpoints:
  - port: http
    path: /metrics
    interval: 30s
    scrapeTimeout: 10s

---
apiVersion: v1
kind: PodSecurityPolicy
metadata:
  name: phase36-billing-psp
  labels:
    app: phase36-billing
spec:
  privileged: false
  allowPrivilegeEscalation: false
  requiredDropCapabilities:
    - ALL
  volumes:
    - 'configMap'
    - 'emptyDir'
    - 'projected'
    - 'secret'
    - 'downwardAPI'
    - 'persistentVolumeClaim'
  runAsUser:
    rule: 'MustRunAsNonRoot'
  seLinux:
    rule: 'RunAsAny'
  fsGroup:
    rule: 'RunAsAny'
  readOnlyRootFilesystem: true
